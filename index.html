<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Tic Tac Toe Game</title>
</head>

<style>
    body,
    html {
        height: 100vh;
        width: 100vw;
        margin: 0;
        flex-direction: column;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    #fieldArea {
        display: grid;
        grid-template-columns: 100px 100px 100px;
        grid-template-rows: 100px 100px 100px;

    }

    .singleField {
        border: 1px solid red;
        width: 100px;
        height: 100px;
    }

    .singleField:hover {
        background-color: azure;
    }

    button {
        margin-top: 150px;
        cursor: pointer;
        font-size: 1em;
        padding: 10px;
        background-color: yellow;
        border: 3px solid darkblue;
    }
</style>

<body>
    <div id="fieldArea">
        <div id="1" class="singleField"></div>
        <div id="2" class="singleField"></div>
        <div id="3" class="singleField"></div>
        <div id="4" class="singleField"></div>
        <div id="5" class="singleField"></div>
        <div id="6" class="singleField"></div>
        <div id="7" class="singleField"></div>
        <div id="8" class="singleField"></div>
        <div id="9" class="singleField"></div>
    </div>

    <button id="button">New Game</button>

    <script>
        function gameLogic() {

            // declare variables
            var clickedField = [];
            var arrayRows = [
                ['1', '2', '3'],
                ['4', '5', '6'],
                ['7', '8', '9'],
                ['1', '4', '7'],
                ['2', '5', '8'],
                ['3', '6', '9'],
                ['1', '5', '9'],
                ['3', '5', '7']
            ]
            var userXArray = {
                name: "userX",
                values: []
            };
            var userOArray = {
                name: 'userO',
                values: []
            };
            var winner = '';
            var user = 'X';

            var fieldArea = document.getElementById('fieldArea')
            var buttom = document.getElementById('button');

            //event listeners for button and field

            button.addEventListener('click', function (event) {

                var elements = document.getElementsByClassName('singleField');
                for (var i = 0; i < elements.length; i++) {
                    elements[i].innerHTML = '';
                }
                clickedField = [];
                userOArray.values = [];
                userXArray.values = [];
                user = 'X';
                winner = '';
            })

            fieldArea.addEventListener('click', function (event) {

                if (clickedField.includes(event.target.id) && clickedField.length < 9) {
                    console.log('this field is occupied already')
                } else if (winner === 'userO' || winner === 'userX') {
                    console.log('This Game is won by' + '' + winner + '. Start a new game.')
                } else if (winner === 'no one' && clickedField.length === 9) {
                    console.log('This Game is over. Start a new Game')

                } else {

                    clickedField.push(event.target.id);



                    var clickedElement = event.target.id;


                    if (user === 'O') {
                        userOArray.values.push(clickedElement);
                        event.target.innerHTML = 'O'
                        user = 'X'

                    } else { // if it is X
                        userXArray.values.push(clickedElement);
                        user = 'O';
                        event.target.innerHTML = 'X';
                    }

                    if (userXArray.values.length >= 3 && user === 'O') {
                        checkForThree(userXArray);
                    }

                    if (userOArray.values.length >= 3 && user === 'X') {
                        checkForThree(userOArray);
                    }

                }

            })





            function checkForThree(userArray) {


                for (var i = 0; i < arrayRows.length; i++) {



                    compare(arrayRows[i], userArray)

                    if (winner === 'userO') {

                        console.log('O won')
                        break;

                    } else if (winner === 'userX') {
                        console.log('userX won')
                        break;
                    } else if (winner === 'no one' && clickedField.length === 9) {

                        console.log('Game Over! No one won')
                        break;

                    }





                }
            }

            function compare(currentArray, userArray) {

                var matches = userArray.values.filter(element => currentArray.includes(element));


                if (matches.length === 3) {
                    winner = userArray.name;

                    return true;
                } else {
                    winner = 'no one'
                }





            }
        }
    </script>
</body>

</html>